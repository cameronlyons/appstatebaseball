---
title: "Cole McNamee"
---

<hr>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, comment = NA, message = FALSE)
library(tidyverse)
library(ggplot2)
library(plotly)
library(data.table)
wake1 <- list.files("~/Appalachian State Baseball/Git Repositories/appstatebaseball/wake_files", pattern = "*.csv", full.names = TRUE)
wake <- rbindlist(lapply(wake1,fread))
Hitter <- wake %>%
  filter(Batter == "McNamee, Cole")
```

```{r}
s <- sum(str_count(Hitter$PlayResult, "Single"))
do <- sum(str_count(Hitter$PlayResult, "Double"))
t <- sum(str_count(Hitter$PlayResult, "Triple"))
hr <- sum(str_count(Hitter$PlayResult, "HomeRun"))
hit <- sum(s + do + t + hr)
inpl <- sum(str_count(Hitter$PitchCall, "InPlay"))
rbi <- sum(Hitter$RunsScored)
bb <- sum(str_count(Hitter$KorBB, "Walk"))
hbp <- sum(str_count(Hitter$PitchCall, "HitByPitch"))
walk <- sum(hbp + bb)
sac <- sum(str_count(Hitter, "Sacrifice"))
es <- Hitter %>%
  filter(PitchCall == "InPlay" & ExitSpeed & !Hitter$HitType == "Bunt")
la <- Hitter %>%
  filter(PitchCall == "InPlay" & Angle & !Hitter$HitType == "Bunt")
so <- sum(str_count(Hitter$KorBB, "Strikeout"))
pa <- inpl + walk + so
ab <- pa - walk - sac
avg <- hit / ab
obp <- (hit + walk) / pa
tb <- sum(s + (2 * do) + (3 * t) + (4 * hr)) 
slg <- tb / ab
ops <- obp + slg
az <- data.frame(Hitter$BatterSide)
az <- az[1,1]
```

Batter Side: `r az` | | | | | | | Hitting Summary 
-|-|-|-|-|-|-|-
PA:|`r pa`| 2B:| `r do` | RBI: |`r rbi`| AVG: |`r round(avg, digits = 3)` |
AB: |`r ab` | 3B: | `r t` | BB: |`r bb` |SLG: | `r round(slg, digits = 3)`|
Hits: |`r hit`| HR: | `r hr` | HBP: | `r hbp` | OPS: | `r round(ops, digits = 3)`|
 | SO: |`r so` ||||| OBP: | `r round(obp, digits = 3)`

Hits| | 
-|-|
AVG Exit Velocity: | `r round(mean(es$ExitSpeed, na.rm = TRUE), digits = 2)` mph
Max Exit Velocity: | `r round(max(es$ExitSpeed, na.rm = TRUE), digits = 2)` mph
AVG Launch Angle: | `r round(mean(la$Angle, na.rm = TRUE), digits = 2)` degrees
Max Estimated Distance: | `r round(max(Hitter$Distance, na.rm = TRUE), digits = 2)` feet

```{r}
Hitter$Bearing <- ((Hitter$Bearing * -1) + 90)*pi/180
Hitter$x <- Hitter$Distance*cos(Hitter$Bearing)
Hitter$y <- Hitter$Distance*sin(Hitter$Bearing)
bases <- data.frame(xa = c(0, 90/sqrt(2), 0, -90/sqrt(2), 0, rep(0)),
ya = c(0, 90/sqrt(2), 2 * 90/sqrt(2), 90/sqrt(2), 0, rep(0)))
x <- c(-.95,.95,.95,-.95,-.95)
z <- c(1.6,1.6,3.5,3.5,1.6)
sz <- data.frame(x, z)
```

```{r  All Pitchers Spray Chart}
sprayfilter <- Hitter %>%
  filter(!PlayResult == "Undefined" & !PlayResult == "Sacrifice")
a <- ggplot(bases, aes(x = xa, y = ya)) + 
  geom_path() + 
  geom_point(data = sprayfilter, x = sprayfilter$x, y = sprayfilter$y, 
             aes(color = factor(sprayfilter$PlayResult), 
                 text = paste("Exit Speed: ", ExitSpeed, 
                               "<br> Distance: ", Distance,
                               "<br> Launch Angle: ", Angle), 
                 shape = factor(sprayfilter$PlayResult))) + 
  geom_segment(x = 0, xend = -233.35, y = 0, yend = 233.35) +
  geom_segment(x = -233.35, xend = -160.59, y = 233.35, yend = 340) + 
  geom_segment(x = -160.59, xend = -49.36, y = 340, yend = 401.98) +
  geom_segment(x = -49.36, xend = 49.36, y = 401.98, yend = 401.98) +
  geom_segment(x = 49.36, xend = 157.67, y = 401.98, yend = 338.05) +
  geom_segment(x = 157.67, xend = 229.81, y = 338.05, yend = 229.81) +
  geom_segment(x = 229.81, xend = 0, y = 229.81, yend = 0) +
  xlim(-250, 250) + ylim(-10, 500) +
  theme(axis.line = element_blank(),
      axis.text.x = element_blank(),
      axis.text.y = element_blank(),
      axis.ticks = element_blank(),
      axis.title.x = element_blank(),
      axis.title.y = element_blank(),
      panel.background = element_blank(),
      panel.border = element_blank(),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      plot.background = element_blank(),
      legend.title = element_blank()) +
  coord_equal() +
  scale_color_discrete(limits = c("Single" ,"Double", "Triple", "HomeRun", "Out", "FieldersChoice", "Error")) +
  scale_shape_discrete(limits = c("Single" ,"Double", "Triple", "HomeRun", "Out", "FieldersChoice", "Error")) +
  ggtitle("Spray Chart")
ggplotly(a, tooltip = "text")
```


```{r  Right Pitchers Spray Chart}
sprayfilter <- Hitter %>%
  filter(!PlayResult == "Undefined" & !PlayResult == "Sacrifice" & PitcherThrows == "Right")
b <- ggplot(bases, aes(x = xa, y = ya)) + 
  geom_path() + 
  geom_point(data = sprayfilter, x = sprayfilter$x, y = sprayfilter$y, 
             aes(color = factor(sprayfilter$PlayResult), 
                 text = paste("Exit Speed: ", ExitSpeed, 
                               "<br> Distance: ", Distance,
                               "<br> Launch Angle: ", Angle), 
                 shape = factor(sprayfilter$PlayResult))) + 
  geom_segment(x = 0, xend = -233.35, y = 0, yend = 233.35) +
  geom_segment(x = -233.35, xend = -160.59, y = 233.35, yend = 340) + 
  geom_segment(x = -160.59, xend = -49.36, y = 340, yend = 401.98) +
  geom_segment(x = -49.36, xend = 49.36, y = 401.98, yend = 401.98) +
  geom_segment(x = 49.36, xend = 157.67, y = 401.98, yend = 338.05) +
  geom_segment(x = 157.67, xend = 229.81, y = 338.05, yend = 229.81) +
  geom_segment(x = 229.81, xend = 0, y = 229.81, yend = 0) +
  xlim(-250, 250) + ylim(-10, 500) +
  theme(axis.line = element_blank(),
      axis.text.x = element_blank(),
      axis.text.y = element_blank(),
      axis.ticks = element_blank(),
      axis.title.x = element_blank(),
      axis.title.y = element_blank(),
      panel.background = element_blank(),
      panel.border = element_blank(),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      plot.background = element_blank(),
      legend.title = element_blank()) +
  coord_equal() +
  scale_color_discrete(limits = c("Single" ,"Double", "Triple", "HomeRun", "Out", "FieldersChoice", "Error")) +
  scale_shape_discrete(limits = c("Single" ,"Double", "Triple", "HomeRun", "Out", "FieldersChoice", "Error")) +
  ggtitle("Right Handed Pitchers")
ggplotly(b, tooltip = "text")
```

```{r  Left Pitchers Spray Chart}
sprayfilter <- Hitter %>%
  filter(!PlayResult == "Undefined" & !PlayResult == "Sacrifice" & PitcherThrows == "Left")
c <- ggplot(bases, aes(x = xa, y = ya)) + 
  geom_path() + 
  geom_point(data = sprayfilter, x = sprayfilter$x, y = sprayfilter$y, 
             aes(color = factor(sprayfilter$PlayResult), 
                 text = paste("Exit Speed: ", ExitSpeed, 
                               "<br> Distance: ", Distance,
                               "<br> Launch Angle: ", Angle), 
                 shape = factor(sprayfilter$PlayResult))) + 
  geom_segment(x = 0, xend = -233.35, y = 0, yend = 233.35) +
  geom_segment(x = -233.35, xend = -160.59, y = 233.35, yend = 340) + 
  geom_segment(x = -160.59, xend = -49.36, y = 340, yend = 401.98) +
  geom_segment(x = -49.36, xend = 49.36, y = 401.98, yend = 401.98) +
  geom_segment(x = 49.36, xend = 157.67, y = 401.98, yend = 338.05) +
  geom_segment(x = 157.67, xend = 229.81, y = 338.05, yend = 229.81) +
  geom_segment(x = 229.81, xend = 0, y = 229.81, yend = 0) +
  xlim(-250, 250) + ylim(-10, 500) +
  theme(axis.line = element_blank(),
      axis.text.x = element_blank(),
      axis.text.y = element_blank(),
      axis.ticks = element_blank(),
      axis.title.x = element_blank(),
      axis.title.y = element_blank(),
      panel.background = element_blank(),
      panel.border = element_blank(),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      plot.background = element_blank(),
      legend.title = element_blank()) +
  coord_equal() +
  scale_color_discrete(limits = c("Single" ,"Double", "Triple", "HomeRun", "Out", "FieldersChoice", "Error")) +
  scale_shape_discrete(limits = c("Single" ,"Double", "Triple", "HomeRun", "Out", "FieldersChoice", "Error")) +
  ggtitle("Left Handed Pitchers")
ggplotly(c, tooltip = "text")
```

<hr>