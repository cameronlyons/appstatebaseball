---
title: "Carter Bach"
---

<hr>

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, error = FALSE)
library(tidyverse)
library(ggplot2)
library(plotly)
library(data.table)
wake1 <- list.files("~/Appalachian State Baseball/Git Repositories/appstatebaseball/wake_files", pattern = "*.csv", full.names = TRUE)
wake <- rbindlist(lapply(wake1,fread))
Pitcher <- wake %>%
  filter(Pitcher == "Bach, Carter")
```


```{r}
x <- c(-.95,.95,.95,-.95,-.95)
z <- c(1.6,1.6,3.5,3.5,1.6)
sz <- data.frame(x, z)
fb <- Pitcher %>%
  filter(TaggedPitchType == "Fastball")
fbr <- range(fb$RelSpeed, na.rm = TRUE)
fbm <- mean(fb$RelSpeed, na.rm = TRUE)
fbs <- mean(fb$SpinRate, na.rm = TRUE)
ch <- Pitcher %>%
  filter(TaggedPitchType == "ChangeUp")
chr <- range(ch$RelSpeed, na.rm = TRUE)
chm <- mean(ch$RelSpeed, na.rm = TRUE)
chs <- mean(ch$SpinRate, na.rm = TRUE)
sl <- Pitcher %>%
  filter(TaggedPitchType == "Slider")
slr <- range(sl$RelSpeed, na.rm = TRUE)
slm <- mean(sl$RelSpeed, na.rm = TRUE)
sls <- mean(sl$SpinRate, na.rm = TRUE)
th <- data.frame(Pitcher$PitcherThrows)
th <- th[1,1]
```

Throws: `r th` | | 
-|-|
Fastball Velocity Range: | `r round(fbr, digits = 2, col = "red")` mph
Fastball Velocity Avg: | `r round(fbm, digits = 2)` mph
Fastball Spin Avg: | `r round(fbs, digits = 2)` rpm
ChangeUp Velocity Range: | `r round(chr, digits = 2)` mph
ChangeUp Velocity Avg: | `r round(chm, digits = 2)` mph
ChangeUp Spin Avg: | `r round(chs, digits = 2)` rpm
Slider Velocity Range: | `r round(slr, digits = 2)` mph
Slider Velocity Avg: | `r round(slm, digits = 2)` mph
Slider Spin Avg: | `r round(sls, digits = 2)` rpm

<center>
```{r All Pitches, echo = FALSE, warning = FALSE, error = FALSE}
all <- Pitcher 
a <- ggplot() +
  geom_path(data = sz, aes(x = x, y = z)) + 
  geom_point(data = all, aes(x = all$PlateLocSide, y = all$PlateLocHeight, color = all$TaggedPitchType, shape = all$TaggedPitchType, text = paste("Pitch Type: ", TaggedPitchType, "<br>Velocity: ", RelSpeed, "<br>Spin Rate: ", SpinRate))) +
  coord_cartesian(xlim = c(-2.5, 2.5), ylim = c(0, 5)) + 
    theme_bw() +
  ggtitle("All Pitches") +
  xlab("Plate Width") +
  ylab("Plate Height") +  
  labs(color = "Pitch Type", shape = "Pitch Type") +
  scale_color_discrete(limits = c("Fastball" ,"ChangeUp", "Splitter", "Curveball", "Slider")) +
  scale_shape_discrete(limits = c("Fastball" ,"ChangeUp", "Splitter", "Curveball", "Slider")) +
  coord_cartesian(xlim = c(-3, 3), ylim = c(0, 5)) +
  theme(axis.line = element_blank(),
        panel.background = element_blank(),
        panel.border = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.background = element_blank(),
        legend.title = element_blank())
ggplotly(a, tooltip = "text")
```

```{r Right Handed Batter, echo = FALSE, warning = FALSE, error = FALSE}
strikerl <- Pitcher %>%
  filter(BatterSide == "Right")
c <- ggplot() +
  geom_path(data = sz, aes(x = x, y = z)) + 
  geom_point(data = strikerl, aes(x = strikerl$PlateLocSide, y = strikerl$PlateLocHeight, color = strikerl$TaggedPitchType, shape = strikerl$TaggedPitchType, text = paste("Pitch Type: ", TaggedPitchType, "<br>Velocity: ", RelSpeed, "<br>Spin Rate: ", SpinRate))) +
  coord_cartesian(xlim = c(-2.5, 2.5), ylim = c(0, 5)) + 
    theme_bw() +
  ggtitle("Right Handed Batter") +
  xlab("Plate Width") +
  ylab("Plate Height") +  
  labs(color = "Pitch Type", shape = "Pitch Type") +
  scale_color_discrete(limits = c("Fastball" ,"ChangeUp", "Splitter", "Curveball", "Slider")) +
  scale_shape_discrete(limits = c("Fastball" ,"ChangeUp", "Splitter", "Curveball", "Slider")) +  
  coord_cartesian(xlim = c(-3, 3), ylim = c(0, 5)) +
  theme(axis.line = element_blank(),
        panel.background = element_blank(),
        panel.border = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.background = element_blank(),
        legend.title = element_blank())
ggplotly(c, tooltip = "text")
```

```{r LL, echo = FALSE, warning = FALSE, error = FALSE}
strikell <- Pitcher %>%
  filter(BatterSide == "Left")
b <- ggplot() +
  geom_path(data = sz, aes(x = x, y = z)) + 
  geom_point(data = strikell, aes(x = strikell$PlateLocSide, y = strikell$PlateLocHeight, color = strikell$TaggedPitchType, shape = strikell$TaggedPitchType, text = paste("Pitch Type: ", TaggedPitchType, "<br>Velocity: ", RelSpeed, "<br>Spin Rate: ", SpinRate))) +
  coord_cartesian(xlim = c(-2.5, 2.5), ylim = c(0, 5)) + 
    theme_bw() +
  ggtitle("Left Handed Batter") +
  xlab("Plate Width") +
  ylab("Plate Height") +  
  labs(color = "Pitch Type", shape = "Pitch Type") +
  scale_color_discrete(limits = c("Fastball" ,"ChangeUp", "Splitter", "Curveball", "Slider")) +
  scale_shape_discrete(limits = c("Fastball" ,"ChangeUp", "Splitter", "Curveball", "Slider")) +  
  coord_cartesian(xlim = c(-3, 3), ylim = c(0, 5)) +
  theme(axis.line = element_blank(),
        panel.background = element_blank(),
        panel.border = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.background = element_blank(),
        legend.title = element_blank())
ggplotly(b, tooltip = "text")
```

```{r Two Strikes, echo = FALSE, warning = FALSE, error = FALSE}
twok <- Pitcher %>%
  filter(Strikes == 2)
twok$Count <- paste(twok$Balls, "-", twok$Strikes, "") 
k <- ggplot() +
  geom_path(data = sz, aes(x = x, y = z)) + 
  geom_point(data = twok, aes(x = twok$PlateLocSide, y = twok$PlateLocHeight, color = twok$TaggedPitchType, shape = twok$TaggedPitchType, text = paste("Pitch Type: ", TaggedPitchType, "<br>Velocity: ", RelSpeed, "<br>Spin Rate: ", SpinRate, "<br>Count: ", Count))) +
  coord_cartesian(xlim = c(-2.5, 2.5), ylim = c(0, 5)) + 
    theme_bw() +
  ggtitle("Two Strike Count") +
  xlab("Plate Width") +
  ylab("Plate Height") +  
  labs(color = "Pitch Type", shape = "Pitch Type") +
  scale_color_discrete(limits = c("Fastball" ,"ChangeUp", "Splitter", "Curveball", "Slider")) +
  scale_shape_discrete(limits = c("Fastball" ,"ChangeUp", "Splitter", "Curveball", "Slider")) +  
  coord_cartesian(xlim = c(-3, 3), ylim = c(0, 5)) +
  theme(axis.line = element_blank(),
        panel.background = element_blank(),
        panel.border = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.background = element_blank(),
        legend.title = element_blank())
ggplotly(k, tooltip = "text")
```
</center>

<hr>